# ========================================
# üîê Protecci√≥n avanzada de firmas digitales
# ========================================

# üö´ 1Ô∏è‚É£ Bloquea cualquier acceso directo desde navegador
<FilesMatch "\.(png|jpg|jpeg|gif)$">
  Require all denied
</FilesMatch>

# ‚úÖ 2Ô∏è‚É£ Permite acceso solo si la petici√≥n viene desde PHP (para FPDF o internos)
<IfModule mod_rewrite.c>
  RewriteEngine On

  # Permitir solo si la petici√≥n viene desde localhost o el dominio del proyecto
  RewriteCond %{HTTP_REFERER} ^http(s)?://(localhost|127\.0\.0\.1)(/interempleo-asistencia)? [NC]

  # Permitir el acceso solo para scripts internos de PHP
  RewriteCond %{THE_REQUEST} "internal_request" [NC]

  # Excepci√≥n para FPDF (necesario para leer firmas dentro del servidor)
  RewriteRule \.(png|jpg|jpeg|gif)$ - [L]

  # Si no cumple las condiciones anteriores ‚Üí Denegar
  RewriteRule \.(png|jpg|jpeg|gif)$ - [F]
</IfModule>

# ========================================
# üß© Nota:
# - Las firmas solo podr√°n ser le√≠das por scripts PHP (ej. FPDF).
# - Si un usuario intenta abrirlas por URL directa ‚Üí 403 Forbidden.
# ========================================
